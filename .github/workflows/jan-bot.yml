name: Jan-Bot-24-7

on:
  workflow_dispatch:       # ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø GitHub UI ‡¶•‡ßá‡¶ï‡ßá ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶¨‡ßá
  push:
    branches:
      - main               # main ‡¶¨‡ßç‡¶∞‡¶æ‡¶û‡ßç‡¶ö‡ßá push ‡¶π‡¶≤‡ßá ‡¶∞‡¶æ‡¶® ‡¶π‡¶¨‡ßá
  schedule:
    - cron: '*/30 * * * *'  # ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß©‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá ‡¶¨‡¶ü ‡¶∞‡¶æ‡¶® ‡¶π‡¶¨‡ßá
    - cron: '*/10 * * * *'  # ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‡ß¶ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá Render wakeup

jobs:
  run-bot:
    runs-on: ubuntu-latest

    env:  
      CI: "true"  
      SIMULATED_INPUT: "‡¶π‡¶æ‡¶®‡¶ø, ‡¶Ü‡¶ú‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶∞‡ßã‡¶Æ‡¶æ‡¶®‡ßç‡¶ü‡¶ø‡¶ï ‡¶π‡¶ì ü•∞"  
      SIMULATED_UID: "100015569688497"  

    steps:  
      - name: Checkout code  
        uses: actions/checkout@v3  

      - name: Show directory content  
        run: ls -la  

      - name: Set up Python  
        uses: actions/setup-python@v4  
        with:  
          python-version: '3.11'  

      - name: Install dependencies  
        run: pip install -r requirements.txt  

      - name: Run Jan Bot  
        run: python main.py

  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Wake up Render Bot
        run: |
          curl --silent https://sky-client.onrender.com/ping

  setup-uptimerobot:
    runs-on: ubuntu-latest
    steps:
      - name: Add UptimeRobot monitor for Replit
        run: |
          curl -X POST https://api.uptimerobot.com/v2/newMonitor \
          -H 'Content-Type: application/json' \
          -d '{
            "api_key": "u3038492-1173a67cf6065e2861e3f141",
            "format": "json",
            "type": 1,
            "friendly_name": "Jan Bot",
            "url": "https://db49dbbd-69ff-4dea-9e17-dc9323f4c455-00-3uawvzwjd4v2k.pike.replit.dev/",
            "interval": 300
          }'
